import{j as e}from"./jsx-runtime-u17CrQMm.js";import{r as a}from"./iframe-vYzePaRW.js";import{S as W}from"./Slider-CF0xPqOC.js";import{B as C}from"./Button-Bvw_y_KB.js";import{c as Y}from"./utils-CDN07tui.js";import{c as $}from"./createLucideIcon-Ckxz52bH.js";import{Z as O,R as U}from"./zoom-in-DwgXnesV.js";import{X as B}from"./x-qgr8oPc5.js";import{C as Z}from"./check-Bwk7sq60.js";import"./preload-helper-PPVm8Dsz.js";import"./proxy-DMGrdN83.js";const z=[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]],A=$("crop",z),S=({src:o,aspectRatio:c=1,onCrop:m,onCancel:h,className:_})=>{const[r,E]=a.useState(null),[i,g]=a.useState(1),[k,H]=a.useState(1),[l,M]=a.useState(0),[n,f]=a.useState({x:0,y:0}),[R,j]=a.useState(!1),[d,T]=a.useState({x:0,y:0}),q=a.useRef(null);a.useRef(null),a.useEffect(()=>{const t=new Image;t.src=o,t.crossOrigin="anonymous",t.onload=()=>{E(t);const s=300,w=300/c,b=s/t.naturalWidth,N=w/t.naturalHeight,D=Math.max(b,N);H(D),g(D)}},[o,c]);const L=t=>{j(!0),T({x:t.clientX-n.x,y:t.clientY-n.y})},X=t=>{R&&(t.preventDefault(),f({x:t.clientX-d.x,y:t.clientY-d.y}))},v=()=>{j(!1)},P=t=>{j(!0);const s=t.touches[0];T({x:s.clientX-n.x,y:s.clientY-n.y})},V=t=>{if(!R)return;const s=t.touches[0];f({x:s.clientX-d.x,y:s.clientY-d.y})},y=a.useCallback(()=>{if(!r||!q.current)return;const t=document.createElement("canvas"),s=t.getContext("2d");if(!s)return;const w=300,b=300/c;t.width=w,t.height=b,s.translate(t.width/2,t.height/2),s.rotate(l*Math.PI/180),s.scale(i,i),s.translate(n.x,n.y),s.drawImage(r,-r.naturalWidth/2,-r.naturalHeight/2);const N=t.toDataURL("image/jpeg",.9);m(N)},[r,i,l,n,c,m]);return a.useEffect(()=>{const t=setTimeout(()=>{r&&y()},100);return()=>clearTimeout(t)},[r,i,l,n,y]),e.jsxs("div",{className:Y("flex flex-col gap-4 w-full max-w-2xl mx-auto p-4 bg-surface-primary rounded-2xl shadow-sm border border-border-primary",_),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-text-primary flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"Edit Image"]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(C,{variant:"ghost",size:"sm",onClick:()=>{g(k),M(0),f({x:0,y:0})},children:"Reset"})})]}),e.jsxs("div",{className:"relative w-full h-[400px] bg-[#1c1c1e] rounded-xl overflow-hidden cursor-move touch-none select-none flex items-center justify-center",ref:q,onMouseDown:L,onMouseMove:X,onMouseUp:v,onMouseLeave:v,onTouchStart:P,onTouchMove:V,onTouchEnd:v,children:[r&&e.jsx("div",{style:{transform:`translate(${n.x}px, ${n.y}px) rotate(${l}deg) scale(${i})`,transformOrigin:"center",width:r.naturalWidth,height:r.naturalHeight,position:"absolute",left:"50%",top:"50%",marginLeft:-r.naturalWidth/2,marginTop:-r.naturalHeight/2},children:e.jsx("img",{src:o,alt:"Edit",className:"max-w-none pointer-events-none select-none",draggable:!1})}),e.jsxs("div",{className:"absolute pointer-events-none border-2 border-white shadow-[0_0_0_9999px_rgba(0,0,0,0.7)]",style:{width:300,height:300/c},children:[e.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[e.jsx("div",{className:"flex-1 border-b border-white/30"}),e.jsx("div",{className:"flex-1 border-b border-white/30"}),e.jsx("div",{className:"flex-1"})]}),e.jsxs("div",{className:"absolute inset-0 flex",children:[e.jsx("div",{className:"flex-1 border-r border-white/30"}),e.jsx("div",{className:"flex-1 border-r border-white/30"}),e.jsx("div",{className:"flex-1"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 px-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(O,{className:"w-4 h-4 text-text-secondary"}),e.jsx(W,{value:i,min:.1,max:3,step:.01,onValueChange:t=>g(t),className:"flex-1"}),e.jsxs("span",{className:"text-xs font-mono w-12 text-right text-text-secondary",children:[Math.round(i*100),"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(U,{className:"w-4 h-4 text-text-secondary"}),e.jsx(W,{value:l,min:-180,max:180,step:1,onValueChange:t=>M(t),className:"flex-1"}),e.jsxs("span",{className:"text-xs font-mono w-12 text-right text-text-secondary",children:[l,"Â°"]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-6",children:[e.jsxs(C,{variant:"ghost",onClick:h,children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(C,{variant:"primary",onClick:y,children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Crop Image"]})]})]})};S.__docgenInfo={description:"",methods:[],displayName:"ImageCropper",props:{src:{required:!0,tsType:{name:"string"},description:""},aspectRatio:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"1",computed:!1}},onCrop:{required:!0,tsType:{name:"signature",type:"function",raw:"(croppedImage: string) => void",signature:{arguments:[{type:{name:"string"},name:"croppedImage"}],return:{name:"void"}}},description:""},onCancel:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};const ne={title:"Data Display/ImageCropper",component:S,parameters:{layout:"centered"},tags:[]},I=o=>{const[c,m]=a.useState(null);return e.jsxs("div",{className:"flex flex-col gap-8 items-center",children:[e.jsx(S,{...o,onCrop:h=>m(h),onCancel:()=>m(null)}),c&&e.jsxs("div",{className:"flex flex-col gap-2 items-center animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),e.jsx("div",{className:"p-2 bg-white rounded-xl shadow-lg border border-gray-100",children:e.jsx("img",{src:c,alt:"Cropped result",className:"rounded-lg max-w-[300px]"})})]})]})},p={render:o=>e.jsx(I,{...o}),args:{src:"https://images.unsplash.com/photo-1682687220742-aba13b6e50ba?q=80&w=2070&auto=format&fit=crop",aspectRatio:1}},u={render:o=>e.jsx(I,{...o}),args:{src:"https://images.unsplash.com/photo-1472214103451-9374bd1c798e?q=80&w=2070&auto=format&fit=crop",aspectRatio:16/9}},x={render:o=>e.jsx(I,{...o}),args:{src:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1888&auto=format&fit=crop",aspectRatio:3/4}};p.parameters={...p.parameters,docs:{...p.parameters?.docs,source:{originalSource:`{
  render: args => <ImageCropperWithState {...args} />,
  args: {
    src: 'https://images.unsplash.com/photo-1682687220742-aba13b6e50ba?q=80&w=2070&auto=format&fit=crop',
    aspectRatio: 1
  }
}`,...p.parameters?.docs?.source}}};u.parameters={...u.parameters,docs:{...u.parameters?.docs,source:{originalSource:`{
  render: args => <ImageCropperWithState {...args} />,
  args: {
    src: 'https://images.unsplash.com/photo-1472214103451-9374bd1c798e?q=80&w=2070&auto=format&fit=crop',
    aspectRatio: 16 / 9
  }
}`,...u.parameters?.docs?.source}}};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:`{
  render: args => <ImageCropperWithState {...args} />,
  args: {
    src: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1888&auto=format&fit=crop',
    aspectRatio: 3 / 4
  }
}`,...x.parameters?.docs?.source}}};const ce=["Default","Landscape","Portrait"];export{p as Default,u as Landscape,x as Portrait,ce as __namedExportsOrder,ne as default};
